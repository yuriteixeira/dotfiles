command! Focus set fcs=eob:\ | Goyo | Limelight!! | set nocul " Focus mode
command MarksReset delm! | delm A-Z0-9                        " Delete all marks

""" Filesystem
command PathFull let @+ = expand("%:p")                       " Full path
nnoremap <leader>ff :PathFull<CR>|

command PathRel let @+ = expand("%")                          " Relative path
nnoremap <leader>fr :PathRel<CR>|

command PathFilename let @+ = expand("%:t")                   " Just filename
nnoremap <leader>fn :PathName<CR>|

command PathDir let @+ = expand('%:p:h')                      " Just dir of file
nnoremap <leader>fd :PathDir<CR>|

command -nargs=* PathDirEdit edit %:p:h/<args>                " Edit file inside current dir
nnoremap <leader>fc :PathDirEdit <C-R><C-W>|
command -nargs=1 New PathDirEdit <args>                

""" Formating
" https://vim.fandom.com/wiki/Shifting_blocks_visually
vnoremap <Tab> >gv
vnoremap <S-Tab> <gv
nnoremap <leader>c :ALEFix<CR>|                           " Fixer
nnoremap <leader>l :ALELint<CR>|                          " Linter

""" Navigation
nnoremap <leader>? :help <C-R><C-W>|                       " Provide help

nnoremap <leader><leader> :b#<CR>|                         " Buffers: Toggle current buffer with last opened one
nnoremap <leader>b :Buffers<CR>|                           " Fuzzy finder: Buffers
nnoremap <leader>a :Files<CR>|                             " Fuzzy finder: Files
nnoremap <leader>d :DirFiles<CR>|                          " Fuzzy finder: Files relative to current file directory
nnoremap <leader>p :History<CR>|                           " Fuzzy finder: History
nnoremap <leader>m :Marks<CR>|                             " Fuzzy finder: Marks

nnoremap <leader>qq :q<CR>|                                " Exit: close current
nnoremap <leader>qa :qa<CR>|                               " Exit: close all

nnoremap <leader>sa :Ag <C-R><C-W>|                        " Search (FZF): word under cursor
nnoremap <leader>st :Tags <C-R><C-W>|                      " Search (FZF): CTags

nnoremap <leader>gg :GFiles?|                              " Git: Changed files
nnoremap <leader>gf :GFiles!?|                             " Git: Changed files (Fullscreen)

nnoremap <C-t> :Lexplore<CR>|                              " File tree (Bundled): Show all

""" Misc
nnoremap <leader>$ :set list!<CR>                          " Toggle hidden characters
nnoremap <leader>z :ZoomToggle<CR>                         " Toggle zoom to current window split

""" Search / Replace
nnoremap <leader>rr :%s///g<left><left><left>|             " Replace: will put cursor in position to add search criteria
nnoremap <leader>rw :%s/<C-R><C-W>//g<left><left>|         " Replace: word under cursor (will put cursor in position to add replacement)
nnoremap <leader>re :%s/\<<C-R><C-W>\>//g<left><left>|     " Replace: word under cursor (will put cursor in position to add replacement)

""" Completion
inoremap <C-Space> <C-n>|                              " Word completion
inoremap <S-Space> <C-x><C-o>|                         " Omni completion
inoremap <C-f> <C-x><C-f>|                             " File completion

" See https://vim.fandom.com/wiki/Make_Vim_completion_popup_menu_work_just_like_in_an_IDE

" Enter selects option
inoremap <expr> <CR> pumvisible() ? "\<C-y>" : "\<C-g>u\<CR>"

" Bettern C-n/C-Space, inside menu
inoremap <expr> <C-n> pumvisible() ? '<C-n>' :
  \ '<C-n><C-r>=pumvisible() ? "\<lt>Down>" : ""<CR>'
inoremap <expr> <C-Space> pumvisible() ? '<C-n>' :
  \ '<C-n><C-r>=pumvisible() ? "\<lt>Down>" : ""<CR>'

" Menu closing previous if open and opening new menu without changing the text
inoremap <expr> <C-Space> (pumvisible() ? (col('.') > 1 ? '<Esc>i<Right>' : '<Esc>i') : '') .
  \ '<C-x><C-o><C-r>=pumvisible() ? "\<lt>C-n>\<lt>C-p>\<lt>Down>" : ""<CR>'

" Menu closing previous if open and opening new menu without changing the text
inoremap <expr> <S-Space> (pumvisible() ? (col('.') > 1 ? '<Esc>i<Right>' : '<Esc>i') : '') .
  \ '<C-x><C-u><C-r>=pumvisible() ? "\<lt>C-n>\<lt>C-p>\<lt>Down>" : ""<CR>'
